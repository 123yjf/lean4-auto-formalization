-- Proof content:
-- 1. [Problem Restatement] We fix the list of base-3 digits base3_digits = [2, 2, 2, 1] and the function digits_to_nat base digits := List.foldr (fun digit acc => digit + base * acc) 0. We show:
   (a) digits_to_nat 3 base3_digits = 53.
   (b) 1 * 3^3 + 2 * 3^2 + 2 * 3^1 + 2 * 3^0 = 53.
   (c) digits_to_nat 3 base3_digits equals the usual positional-value expansion 1 * 3^3 + 2 * 3^2 + 2 * 3^1 + 2 * 3^0.

-- 2. [Key Idea] The function digits_to_nat is Horner’s method applied to the list of digits using the given base: folding right with (digit, acc) ↦ digit + base * acc turns a concrete digit list [a, b, c, d] into a + base*(b + base*(c + base*(d + base*0))). This exactly matches the positional-value sum a*base^0 + b*base^1 + c*base^2 + d*base^3 when the most significant digit is at the end of the list. The proofs proceed by unfolding the definitions and simplifying arithmetic; for the numeric equality with powers of 3, we just compute the powers and sums.

-- 3. [Proof]
   (a) For digits_to_nat 3 [2, 2, 2, 1]:
       Unfold the definitions of digits_to_nat and base3_digits. The right fold over the explicit list with the step (digit, acc) ↦ digit + 3*acc expands to
       2 + 3*(2 + 3*(2 + 3*(1 + 3*0))).
       Simplifying 3*0 = 0 gives 1 + 3*0 = 1, so this becomes
       2 + 3*(2 + 3*(2 + 3*1)) = 2 + 3*(2 + 3*(2 + 3)).
       Evaluating step by step yields 2 + 3*(2 + 3*(5)) = 2 + 3*(2 + 15) = 2 + 3*17 = 2 + 51 = 53.
       The Lean proof accomplishes this automatically by unfolding and using simp to evaluate List.foldr on the concrete list.

   (b) For 1 * 3^3 + 2 * 3^2 + 2 * 3^1 + 2 * 3^0:
       Compute 3^0 = 1, 3^1 = 3, 3^2 = 9, 3^3 = 27. Then
       1*27 + 2*9 + 2*3 + 2*1 = 27 + 18 + 6 + 2 = 53.
       In Lean, norm_num performs these numeric computations automatically.

   (c) For the equivalence between digits_to_nat and the positional expansion:
       Unfold digits_to_nat and base3_digits to get the Horner form
       2 + 3*(2 + 3*(2 + 3*(1 + 3*0))) = 2 + 3*(2 + 3*(2 + 3*1)).
       Distributing 3 step by step shows this equals
       2*3^0 + 2*3^1 + 2*3^2 + 1*3^3,
       i.e., the usual sum of each digit times the corresponding power of 3, with the last list element (1) contributing the highest power. Lean’s simp over the explicit fold reduces the left-hand side to this expression, establishing the equality.

-- 4. [Conclusion] The right-fold definition digits_to_nat correctly interprets [2, 2, 2, 1] as a base-3 numeral, yielding 53. This agrees with the standard positional expansion 1*3^3 + 2*3^2 + 2*3^1 + 2*3^0, and both computations evaluate to 53.